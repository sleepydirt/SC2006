<div class="d-flex flex-row" style="min-height: calc(100vh - 72px);">
  <div class="col-3 px-5 py-4" data-controller="course-filter">
    <%= form_with url: courses_query_path, method: :get, id: "course-filter-form"  do |form| %>
      <div class="mb-4">
        <%= form.label :degree, "Search by Degree", class: "form-label fw-bold" %>
        <%= form.search_field :degree, class: "form-control", placeholder: "e.g. Computer Science", value: params[:degree] %>
      </div>

      <div class="mb-4">
        <%= form.label :university, "University", class: "form-label fw-bold" %>
        <% @universities.each do |university| %>
          <% checkbox_id = "university_#{university.parameterize(separator: '_')}" %>
          <div class="form-check">
            <%= check_box_tag "university[#{university}]", "1", params.dig(:university, university) == "1", class: "form-check-input", id: checkbox_id %>
            <%= label_tag checkbox_id, university, class: "form-check-label" %>
          </div>
        <% end %>
      </div>

      <div class="mb-4">
        <%= form.label :salary_range, "Salary Range (Monthly)", class: "form-label fw-bold" %>
        <%= form.hidden_field :salary_min, value: params[:salary_min] || 0, data: { course_filter_target: "salaryMinInput" } %>
        <%= form.hidden_field :salary_max, value: params[:salary_max] || 10000, data: { course_filter_target: "salaryMaxInput" } %>
        
        <div class="range-slider-container">
          <div class="range-slider-track" data-course-filter-target="salaryTrack"></div>
          <input type="range" 
                 class="form-range range-min" 
                 min="0" 
                 max="10000" 
                 step="100" 
                 value="<%= params[:salary_min] || 0 %>"
                 data-course-filter-target="salaryMinRange"
                 data-action="input->course-filter#updateSalaryRange">
          <input type="range" 
                 class="form-range range-max" 
                 min="0" 
                 max="10000" 
                 step="100" 
                 value="<%= params[:salary_max] || 10000 %>"
                 data-course-filter-target="salaryMaxRange"
                 data-action="input->course-filter#updateSalaryMax">
        </div>
        
        <div class="d-flex justify-content-between mt-2">
          <span class="small text-muted">Min: $<span data-course-filter-target="salaryMinDisplay"><%= number_with_delimiter(params[:salary_min] || 0) %></span></span>
          <span class="small text-muted">Max: $<span data-course-filter-target="salaryMaxDisplay"><%= number_with_delimiter(params[:salary_max] || 10000) %></span></span>
        </div>
      </div>

      <div class="mb-4">
        <%= form.label :employment_rate_range, "Employment Rate Range", class: "form-label fw-bold" %>
        <%= form.hidden_field :employment_rate_min, value: params[:employment_rate_min] || 0, data: { course_filter_target: "employmentMinInput" } %>
        <%= form.hidden_field :employment_rate_max, value: params[:employment_rate_max] || 100, data: { course_filter_target: "employmentMaxInput" } %>
        
        <div class="range-slider-container">
          <div class="range-slider-track" data-course-filter-target="employmentTrack"></div>
          <input type="range" 
                 class="form-range range-min" 
                 min="0" 
                 max="100" 
                 step="1" 
                 value="<%= params[:employment_rate_min] || 0 %>"
                 data-course-filter-target="employmentMinRange"
                 data-action="input->course-filter#updateEmploymentRange">
          <input type="range" 
                 class="form-range range-max" 
                 min="0" 
                 max="100" 
                 step="1" 
                 value="<%= params[:employment_rate_max] || 100 %>"
                 data-course-filter-target="employmentMaxRange"
                 data-action="input->course-filter#updateEmploymentMax">
        </div>
        
        <div class="d-flex justify-content-between mt-2">
          <span class="small text-muted">Min: <span data-course-filter-target="employmentMinDisplay"><%= params[:employment_rate_min] || 0 %></span>%</span>
          <span class="small text-muted">Max: <span data-course-filter-target="employmentMaxDisplay"><%= params[:employment_rate_max] || 100 %></span>%</span>
        </div>
      </div>

      <div class="d-grid gap-2 mb-3">
        <%= form.submit "Apply Filters", class: "btn btn-primary" %>
        <%= link_to "Clear Filters", courses_query_path, class: "btn btn-outline-secondary" %>
      </div>
    <% end %>
  </div>
  
  <div class="col-6 px-5 py-4" style="overflow-y: auto; max-height: calc(100vh - 72px);">
    <% if @courses.any? %>
      <p class="text-muted mb-3"><%= @courses.count %> course(s) found</p>
      <% @courses.each do |course| %>
        <%= render "course", course: course %>
      <% end %>
    <% else %>
      <div class="text-center text-muted mt-5">
        <i class="bi bi-search fs-1 mb-3"></i>
        <p>No courses found matching your criteria.</p>
        <p class="small">Try adjusting your filters.</p>
      </div>
    <% end %>
  </div>
</div>
