<%
  # get uni logos
  logo_map = {
    "Nanyang Technological University" => "ntu_logo.png",
    "National University of Singapore" => "nus_logo.png",
    "Singapore Management University" => "smu_logo.jpg",
    "Singapore University of Technology and Design" => "sutd_logo.png",
    "Singapore Institute of Technology" => "sit_logo.jpg",
    "Singapore University of Social Sciences" => "suss_logo.png"
  }
  university_logo = asset_path(logo_map[course.university]) if logo_map[course.university]
  
  summary = course.course_summary
%>

<div class="card shadow-sm border-0 mb-3 hover-card">
  <div class="card-body p-3">
    <div class="d-flex align-items-start gap-3">
      <div class="university-logo-container flex-shrink-0">
        <img src="<%= university_logo %>" alt="<%= course.university %>" class="university-logo">
      </div>
      <div class="flex-grow-1 min-w-0">
        <a href="<%= course_path(course.id) %>" class="text-reset text-decoration-none">
          <h6 class="fw-bold mb-1 course-title"><%= course.degree %></h6>
          <p class="text-muted small mb-2"><%= course.university %></p>
          
          <% if summary %>
            <div class="d-flex flex-wrap gap-3 small text-secondary">
              <div>
                <i class="bi bi-calendar3 me-1"></i>
                <span class="fw-semibold">AY<%= summary.year %></span>
              </div>
              
              <% if summary.employment_rate_overall && summary.employment_rate_overall > 0 %>
                <div>
                  <i class="bi bi-briefcase me-1"></i>
                  <span class="fw-semibold"><%= number_to_percentage(summary.employment_rate_overall, precision: 1) %></span>
                  <span class="text-muted">employed</span>
                </div>
              <% end %>
              
              <% if summary.salary_range_min && summary.salary_range_max %>
                <div class="d-flex align-items-center">
                  <span class="fw-semibold">$<%= number_with_delimiter(summary.salary_range_min.to_i) %> - $<%= number_with_delimiter(summary.salary_range_max.to_i) %></span>
                  <span class="text-muted ms-1">salary range</span>
                </div>
              <% end %>
            </div>
          <% end %>
        </a>
      </div>


      <% if authenticated? %>
        <div class="flex-shrink-0">
          <turbo-frame id="course_<%= course.id %>">
            <%= form_with url: bookmarks_path do |form| %>
              <%= form.hidden_field :course_id, value: course.id %>
              <button type="submit" class="btn">
                <% if Bookmark.find_by(user: Current.user, course_id: course.id) %>
                  <i class="bi bi-bookmark-fill" style="width: 16px; height: 16px; font-size: 16px;"></i>
                <% else %>
                  <i class="bi bi-bookmark" style="width: 16px; height: 16px; font-size: 16px;"></i>
                <% end %>
              </button>
            <% end %>
          </turbo-frame>
        </div>
      <% end %>
    </div>
  </div>
</div>